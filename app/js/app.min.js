function stockdata(){function link(scope,element,attrs){}return{link:link,templateUrl:"view/table.html",restrict:"EA",controller:StockMarcketData,controllerAs:"vm",bindToController:!0}}function update(data){var prevValue=golbalArray[data[0]].currValue;golbalArray[data[0]].currValue=data[1],golbalArray[data[0]].prevValue=prevValue}function insert(data){var temp={};temp[data[0]]={},temp[data[0]].prevValue=0,temp[data[0]].name=data[0],temp[data[0]].currValue=data[1],golbalArray=Object.assign(golbalArray,temp)}function checkValue(data){return!!golbalArray[data]}function get(data){return golbalArray[data]}function dataTransfrom(data){var transfromData=[];return data.forEach(function(ele,idx){checkValue(ele[0])?update(ele):insert(ele),transfromData.push(get(ele[0]))}),transfromData}function StockMarcketData($scope){$scope.obj={},new WebSocket("ws://stocks.mnet.website/").onmessage=function(event){var stockcollection=[];stockcollection.push(JSON.parse(event.data)),stockcollection.forEach(function(ele,idx,arr){$scope.obj.name=dataTransfrom(ele),$scope.$apply()})}}var app=angular.module("stockapp",[]);app.directive("stockdata",stockdata),StockMarcketData.$inject=["$scope"];var golbalArray={};